// Copyright Vespa.ai. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.

#include "float8_luts.h"

namespace vespalib::hwaccelerated {

// TODO just keep 16 MSBs since 16 LSBs are always zero?
const uint32_t fp8_e5m2_f32_bits_lut[256] = {
    0x00000000, 0x37800000, 0x38000000, 0x38400000, 0x38800000, 0x38a00000, 0x38c00000, 0x38e00000,
    0x39000000, 0x39200000, 0x39400000, 0x39600000, 0x39800000, 0x39a00000, 0x39c00000, 0x39e00000,
    0x3a000000, 0x3a200000, 0x3a400000, 0x3a600000, 0x3a800000, 0x3aa00000, 0x3ac00000, 0x3ae00000,
    0x3b000000, 0x3b200000, 0x3b400000, 0x3b600000, 0x3b800000, 0x3ba00000, 0x3bc00000, 0x3be00000,
    0x3c000000, 0x3c200000, 0x3c400000, 0x3c600000, 0x3c800000, 0x3ca00000, 0x3cc00000, 0x3ce00000,
    0x3d000000, 0x3d200000, 0x3d400000, 0x3d600000, 0x3d800000, 0x3da00000, 0x3dc00000, 0x3de00000,
    0x3e000000, 0x3e200000, 0x3e400000, 0x3e600000, 0x3e800000, 0x3ea00000, 0x3ec00000, 0x3ee00000,
    0x3f000000, 0x3f200000, 0x3f400000, 0x3f600000, 0x3f800000, 0x3fa00000, 0x3fc00000, 0x3fe00000,
    0x40000000, 0x40200000, 0x40400000, 0x40600000, 0x40800000, 0x40a00000, 0x40c00000, 0x40e00000,
    0x41000000, 0x41200000, 0x41400000, 0x41600000, 0x41800000, 0x41a00000, 0x41c00000, 0x41e00000,
    0x42000000, 0x42200000, 0x42400000, 0x42600000, 0x42800000, 0x42a00000, 0x42c00000, 0x42e00000,
    0x43000000, 0x43200000, 0x43400000, 0x43600000, 0x43800000, 0x43a00000, 0x43c00000, 0x43e00000,
    0x44000000, 0x44200000, 0x44400000, 0x44600000, 0x44800000, 0x44a00000, 0x44c00000, 0x44e00000,
    0x45000000, 0x45200000, 0x45400000, 0x45600000, 0x45800000, 0x45a00000, 0x45c00000, 0x45e00000,
    0x46000000, 0x46200000, 0x46400000, 0x46600000, 0x46800000, 0x46a00000, 0x46c00000, 0x46e00000,
    0x47000000, 0x47200000, 0x47400000, 0x47600000, 0x7f800000, 0x7fc00000, 0x7fc00000, 0x7fc00000,
    0x80000000, 0xb7800000, 0xb8000000, 0xb8400000, 0xb8800000, 0xb8a00000, 0xb8c00000, 0xb8e00000,
    0xb9000000, 0xb9200000, 0xb9400000, 0xb9600000, 0xb9800000, 0xb9a00000, 0xb9c00000, 0xb9e00000,
    0xba000000, 0xba200000, 0xba400000, 0xba600000, 0xba800000, 0xbaa00000, 0xbac00000, 0xbae00000,
    0xbb000000, 0xbb200000, 0xbb400000, 0xbb600000, 0xbb800000, 0xbba00000, 0xbbc00000, 0xbbe00000,
    0xbc000000, 0xbc200000, 0xbc400000, 0xbc600000, 0xbc800000, 0xbca00000, 0xbcc00000, 0xbce00000,
    0xbd000000, 0xbd200000, 0xbd400000, 0xbd600000, 0xbd800000, 0xbda00000, 0xbdc00000, 0xbde00000,
    0xbe000000, 0xbe200000, 0xbe400000, 0xbe600000, 0xbe800000, 0xbea00000, 0xbec00000, 0xbee00000,
    0xbf000000, 0xbf200000, 0xbf400000, 0xbf600000, 0xbf800000, 0xbfa00000, 0xbfc00000, 0xbfe00000,
    0xc0000000, 0xc0200000, 0xc0400000, 0xc0600000, 0xc0800000, 0xc0a00000, 0xc0c00000, 0xc0e00000,
    0xc1000000, 0xc1200000, 0xc1400000, 0xc1600000, 0xc1800000, 0xc1a00000, 0xc1c00000, 0xc1e00000,
    0xc2000000, 0xc2200000, 0xc2400000, 0xc2600000, 0xc2800000, 0xc2a00000, 0xc2c00000, 0xc2e00000,
    0xc3000000, 0xc3200000, 0xc3400000, 0xc3600000, 0xc3800000, 0xc3a00000, 0xc3c00000, 0xc3e00000,
    0xc4000000, 0xc4200000, 0xc4400000, 0xc4600000, 0xc4800000, 0xc4a00000, 0xc4c00000, 0xc4e00000,
    0xc5000000, 0xc5200000, 0xc5400000, 0xc5600000, 0xc5800000, 0xc5a00000, 0xc5c00000, 0xc5e00000,
    0xc6000000, 0xc6200000, 0xc6400000, 0xc6600000, 0xc6800000, 0xc6a00000, 0xc6c00000, 0xc6e00000,
    0xc7000000, 0xc7200000, 0xc7400000, 0xc7600000, 0xff800000, 0xffc00000, 0xffc00000, 0xffc00000
};

// TODO just keep 16 MSBs since 16 LSBs are always zero?
// TODO could also be just 128 entries since sign bit is always inherited...
const uint32_t fp8_e4m3fn_f32_bits_lut[256] = {
    0x00000000, 0x3b000000, 0x3b800000, 0x3bc00000, 0x3c000000, 0x3c200000, 0x3c400000, 0x3c600000,
    0x3c800000, 0x3c900000, 0x3ca00000, 0x3cb00000, 0x3cc00000, 0x3cd00000, 0x3ce00000, 0x3cf00000,
    0x3d000000, 0x3d100000, 0x3d200000, 0x3d300000, 0x3d400000, 0x3d500000, 0x3d600000, 0x3d700000,
    0x3d800000, 0x3d900000, 0x3da00000, 0x3db00000, 0x3dc00000, 0x3dd00000, 0x3de00000, 0x3df00000,
    0x3e000000, 0x3e100000, 0x3e200000, 0x3e300000, 0x3e400000, 0x3e500000, 0x3e600000, 0x3e700000,
    0x3e800000, 0x3e900000, 0x3ea00000, 0x3eb00000, 0x3ec00000, 0x3ed00000, 0x3ee00000, 0x3ef00000,
    0x3f000000, 0x3f100000, 0x3f200000, 0x3f300000, 0x3f400000, 0x3f500000, 0x3f600000, 0x3f700000,
    0x3f800000, 0x3f900000, 0x3fa00000, 0x3fb00000, 0x3fc00000, 0x3fd00000, 0x3fe00000, 0x3ff00000,
    0x40000000, 0x40100000, 0x40200000, 0x40300000, 0x40400000, 0x40500000, 0x40600000, 0x40700000,
    0x40800000, 0x40900000, 0x40a00000, 0x40b00000, 0x40c00000, 0x40d00000, 0x40e00000, 0x40f00000,
    0x41000000, 0x41100000, 0x41200000, 0x41300000, 0x41400000, 0x41500000, 0x41600000, 0x41700000,
    0x41800000, 0x41900000, 0x41a00000, 0x41b00000, 0x41c00000, 0x41d00000, 0x41e00000, 0x41f00000,
    0x42000000, 0x42100000, 0x42200000, 0x42300000, 0x42400000, 0x42500000, 0x42600000, 0x42700000,
    0x42800000, 0x42900000, 0x42a00000, 0x42b00000, 0x42c00000, 0x42d00000, 0x42e00000, 0x42f00000,
    0x43000000, 0x43100000, 0x43200000, 0x43300000, 0x43400000, 0x43500000, 0x43600000, 0x43700000,
    0x43800000, 0x43900000, 0x43a00000, 0x43b00000, 0x43c00000, 0x43d00000, 0x43e00000, 0x7fc00000,
    0x80000000, 0xbb000000, 0xbb800000, 0xbbc00000, 0xbc000000, 0xbc200000, 0xbc400000, 0xbc600000,
    0xbc800000, 0xbc900000, 0xbca00000, 0xbcb00000, 0xbcc00000, 0xbcd00000, 0xbce00000, 0xbcf00000,
    0xbd000000, 0xbd100000, 0xbd200000, 0xbd300000, 0xbd400000, 0xbd500000, 0xbd600000, 0xbd700000,
    0xbd800000, 0xbd900000, 0xbda00000, 0xbdb00000, 0xbdc00000, 0xbdd00000, 0xbde00000, 0xbdf00000,
    0xbe000000, 0xbe100000, 0xbe200000, 0xbe300000, 0xbe400000, 0xbe500000, 0xbe600000, 0xbe700000,
    0xbe800000, 0xbe900000, 0xbea00000, 0xbeb00000, 0xbec00000, 0xbed00000, 0xbee00000, 0xbef00000,
    0xbf000000, 0xbf100000, 0xbf200000, 0xbf300000, 0xbf400000, 0xbf500000, 0xbf600000, 0xbf700000,
    0xbf800000, 0xbf900000, 0xbfa00000, 0xbfb00000, 0xbfc00000, 0xbfd00000, 0xbfe00000, 0xbff00000,
    0xc0000000, 0xc0100000, 0xc0200000, 0xc0300000, 0xc0400000, 0xc0500000, 0xc0600000, 0xc0700000,
    0xc0800000, 0xc0900000, 0xc0a00000, 0xc0b00000, 0xc0c00000, 0xc0d00000, 0xc0e00000, 0xc0f00000,
    0xc1000000, 0xc1100000, 0xc1200000, 0xc1300000, 0xc1400000, 0xc1500000, 0xc1600000, 0xc1700000,
    0xc1800000, 0xc1900000, 0xc1a00000, 0xc1b00000, 0xc1c00000, 0xc1d00000, 0xc1e00000, 0xc1f00000,
    0xc2000000, 0xc2100000, 0xc2200000, 0xc2300000, 0xc2400000, 0xc2500000, 0xc2600000, 0xc2700000,
    0xc2800000, 0xc2900000, 0xc2a00000, 0xc2b00000, 0xc2c00000, 0xc2d00000, 0xc2e00000, 0xc2f00000,
    0xc3000000, 0xc3100000, 0xc3200000, 0xc3300000, 0xc3400000, 0xc3500000, 0xc3600000, 0xc3700000,
    0xc3800000, 0xc3900000, 0xc3a00000, 0xc3b00000, 0xc3c00000, 0xc3d00000, 0xc3e00000, 0xffc00000
};

} // vespalib::hwaccelerated
