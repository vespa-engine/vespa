# Copyright Vespa.ai. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.
vespa_define_module(
    DEPENDS
    vespalog
    vespalib
    vespaeval
    vespa_fnet
    vespa_configdefinitions
    vespa_metrics
    vespa_document
    vespa_config

    EXTERNAL_DEPENDS
    ${VESPA_GLIBC_RT_LIB}

    LIBS
    src/vespa/searchlib
    src/vespa/searchlib/aggregation
    src/vespa/searchlib/attribute
    src/vespa/searchlib/bitcompression
    src/vespa/searchlib/common
    src/vespa/searchlib/config
    src/vespa/searchlib/diskindex
    src/vespa/searchlib/docstore
    src/vespa/searchlib/engine
    src/vespa/searchlib/expression
    src/vespa/searchlib/features
    src/vespa/searchlib/features/fieldmatch
    src/vespa/searchlib/features/rankingexpression
    src/vespa/searchlib/fef
    src/vespa/searchlib/fef/test
    src/vespa/searchlib/fef/test/plugin
    src/vespa/searchlib/grouping
    src/vespa/searchlib/index
    src/vespa/searchlib/memoryindex
    src/vespa/searchlib/parsequery
    src/vespa/searchlib/predicate
    src/vespa/searchlib/query
    src/vespa/searchlib/query/streaming
    src/vespa/searchlib/query/tree
    src/vespa/searchlib/queryeval
    src/vespa/searchlib/queryeval/test
    src/vespa/searchlib/queryeval/wand
    src/vespa/searchlib/tensor
    src/vespa/searchlib/test
    src/vespa/searchlib/test/diskindex
    src/vespa/searchlib/test/fakedata
    src/vespa/searchlib/test/features
    src/vespa/searchlib/test/memoryindex
    src/vespa/searchlib/transactionlog
    src/vespa/searchlib/uca
    src/vespa/searchlib/util
    src/vespa/searchcommon/attribute
    src/vespa/searchcommon/common

    APPS
    src/apps/docstore
    src/apps/tests
    src/apps/uniform
    src/apps/vespa-attribute-inspect
    src/apps/vespa-fileheader-inspect
    src/apps/vespa-index-inspect
    src/apps/vespa-query-analyzer
    src/apps/vespa-ranking-expression-analyzer

    TESTS
    src/tests/aggregator
    src/tests/alignment
    src/tests/attribute
    src/tests/attribute/attribute_header
    src/tests/attribute/attribute_operation
    src/tests/attribute/attributefilewriter
    src/tests/attribute/attributemanager
    src/tests/attribute/benchmark
    src/tests/attribute/bitvector
    src/tests/attribute/bitvector_search_cache
    src/tests/attribute/changevector
    src/tests/attribute/compaction
    src/tests/attribute/dfa_fuzzy_matcher
    src/tests/attribute/direct_multi_term_blueprint
    src/tests/attribute/direct_posting_store
    src/tests/attribute/enum_attribute_compaction
    src/tests/attribute/enum_comparator
    src/tests/attribute/enumeratedsave
    src/tests/attribute/enumstore
    src/tests/attribute/extendattributes
    src/tests/attribute/guard
    src/tests/attribute/imported_attribute_vector
    src/tests/attribute/imported_search_context
    src/tests/attribute/multi_term_or_filter_search
    src/tests/attribute/multi_value_mapping
    src/tests/attribute/multi_value_read_view
    src/tests/attribute/posting_list_merger
    src/tests/attribute/posting_store
    src/tests/attribute/postinglist
    src/tests/attribute/postinglistattribute
    src/tests/attribute/predicate_attribute
    src/tests/attribute/raw_attribute
    src/tests/attribute/reference_attribute
    src/tests/attribute/save_target
    src/tests/attribute/searchable
    src/tests/attribute/searchcontext
    src/tests/attribute/searchcontextelementiterator
    src/tests/attribute/sort_blob_writers
    src/tests/attribute/sourceselector
    src/tests/attribute/stringattribute
    src/tests/attribute/tensorattribute
    src/tests/bitcompression/expgolomb
    src/tests/bitvector
    src/tests/common/bitvector
    src/tests/common/geogcd
    src/tests/common/location
    src/tests/common/location_iterator
    src/tests/common/matching_elements
    src/tests/common/matching_elements_fields
    src/tests/common/resultset
    src/tests/common/summaryfeatures
    src/tests/diskindex/bitvector
    src/tests/diskindex/diskindex
    src/tests/diskindex/field_length_scanner
    src/tests/diskindex/fieldwriter
    src/tests/diskindex/fusion
    src/tests/diskindex/pagedict4
    src/tests/diskindex/posting_list_cache
    src/tests/diskindex/zc
    src/tests/docstore/chunk
    src/tests/docstore/document_store
    src/tests/docstore/document_store_visitor
    src/tests/docstore/file_chunk
    src/tests/docstore/lid_info
    src/tests/docstore/logdatastore
    src/tests/docstore/store_by_bucket
    src/tests/engine/proto_converter
    src/tests/engine/proto_rpc_adapter
    src/tests/expression/attributenode
    src/tests/expression/current_index_setup
    src/tests/expression/interpolated_document_field_lookup_node
    src/tests/features
    src/tests/features/beta
    src/tests/features/bm25
    src/tests/features/closest
    src/tests/features/constant
    src/tests/features/element_completeness
    src/tests/features/element_similarity_feature
    src/tests/features/euclidean_distance
    src/tests/features/first_phase_rank
    src/tests/features/imported_dot_product
    src/tests/features/internal_max_reduce_prod_join_feature
    src/tests/features/item_raw_score
    src/tests/features/max_reduce_prod_join_replacer
    src/tests/features/native_dot_product
    src/tests/features/nns_closeness
    src/tests/features/nns_distance
    src/tests/features/onnx_feature
    src/tests/features/ranking_expression
    src/tests/features/raw_score
    src/tests/features/subqueries
    src/tests/features/tensor
    src/tests/features/tensor_from_labels
    src/tests/features/tensor_from_weighted_set
    src/tests/features/text_similarity_feature
    src/tests/features/util
    src/tests/fef
    src/tests/fef/attributecontent
    src/tests/fef/featurenamebuilder
    src/tests/fef/featurenameparser
    src/tests/fef/featureoverride
    src/tests/fef/object_passing
    src/tests/fef/parameter
    src/tests/fef/phrasesplitter
    src/tests/fef/properties
    src/tests/fef/rank_program
    src/tests/fef/resolver
    src/tests/fef/table
    src/tests/fef/termfieldmodel
    src/tests/fef/termmatchdatamerger
    src/tests/fileheadertk
    src/tests/forcelink
    src/tests/grouping
    src/tests/groupingengine
    src/tests/hitcollector
    src/tests/index/field_length_calculator
    src/tests/indexmetainfo
    src/tests/ld_library_path
    src/tests/memoryindex/compact_words_store
    src/tests/memoryindex/datastore
    src/tests/memoryindex/document_inverter
    src/tests/memoryindex/document_inverter_collection
    src/tests/memoryindex/field_index
    src/tests/memoryindex/field_index_remover
    src/tests/memoryindex/field_inverter
    src/tests/memoryindex/memory_index
    src/tests/memoryindex/url_field_inverter
    src/tests/nativerank
    src/tests/nearsearch
    src/tests/postinglistbm
    src/tests/predicate
    src/tests/query
    src/tests/query/streaming
    src/tests/queryeval
    src/tests/queryeval/blueprint
    src/tests/queryeval/dot_product
    src/tests/queryeval/equiv
    src/tests/queryeval/exact_nearest_neighbor
    src/tests/queryeval/fake_searchable
    src/tests/queryeval/filter_search
    src/tests/queryeval/flow
    src/tests/queryeval/getnodeweight
    src/tests/queryeval/global_filter
    src/tests/queryeval/iterator_benchmark
    src/tests/queryeval/matching_elements_search
    src/tests/queryeval/monitoring_search_iterator
    src/tests/queryeval/multibitvectoriterator
    src/tests/queryeval/or_speed
    src/tests/queryeval/parallel_weak_and
    src/tests/queryeval/predicate
    src/tests/queryeval/profiled_iterator
    src/tests/queryeval/same_element
    src/tests/queryeval/simple_phrase
    src/tests/queryeval/sourceblender
    src/tests/queryeval/sparse_vector_benchmark
    src/tests/queryeval/termwise_eval
    src/tests/queryeval/weak_and
    src/tests/queryeval/weak_and_heap
    src/tests/queryeval/weak_and_scorers
    src/tests/queryeval/weighted_set_term
    src/tests/queryeval/wrappers
    src/tests/rankingexpression/intrinsic_blueprint_adapter
    src/tests/ranksetup
    src/tests/ranksetup/verify_feature
    src/tests/searchcommon/attribute/config
    src/tests/searchcommon/schema
    src/tests/sort
    src/tests/sortresults
    src/tests/sortspec
    src/tests/tensor/dense_tensor_store
    src/tests/tensor/direct_tensor_store
    src/tests/tensor/distance_calculator
    src/tests/tensor/distance_functions
    src/tests/tensor/hnsw_best_neighbors
    src/tests/tensor/hnsw_index
    src/tests/tensor/hnsw_nodeid_mapping
    src/tests/tensor/hnsw_saver
    src/tests/tensor/tensor_buffer_operations
    src/tests/tensor/tensor_buffer_store
    src/tests/tensor/tensor_buffer_type_mapper
    src/tests/test/schema_builder
    src/tests/test/string_field_builder
    src/tests/transactionlog
    src/tests/transactionlogstress
    src/tests/true
    src/tests/url
    src/tests/util
    src/tests/util/bufferwriter
    src/tests/util/folded_string_compare
    src/tests/util/index_stats
    src/tests/util/slime_output_raw_buf_adapter
    src/tests/util/token_extractor
    src/tests/vespa-fileheader-inspect
)

install_jar(searchlib.jar)

vespa_install_script(src/main/sh/vespa-gbdt-converter bin)
vespa_install_script(src/main/sh/vespa-treenet-converter bin)
vespa_install_script(src/main/sh/vespa-evaluate-tensor-conformance.sh bin)

